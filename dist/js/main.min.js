"use strict";var boardArr,board=document.querySelector(".board"),rowsCount=4,columnsCount=4,handlePrepareGame=function(){boardArr=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];for(var r=0;r<rowsCount;r++){var e=document.createElement("div");e.classList.add("row");for(var o=0;o<columnsCount;o++){var t=document.createElement("div"),a=(t.setAttribute("id","".concat(r,"-").concat(o)),e.append(t),boardArr[r][o]);handleUpdateTile(t,a),board.appendChild(e)}}addNextValue(),addNextValue()},empty=function(){for(var r=0;r<rowsCount;r++)for(var e=0;e<columnsCount;e++)if(0==boardArr[r][e])return!0;return!1},addNextValue=function(){if(empty)for(var r=!1;!r;){var e=Math.floor(4*Math.random()),o=Math.floor(4*Math.random());0==boardArr[o][e]&&(boardArr[o][e]=2,(o=document.getElementById("".concat(o,"-").concat(e))).innerText="2",o.classList.add("x2"),o.classList.add("tile-animation"),r=!0)}},checkMove=function(r){"ArrowLeft"===r.key?(leftMove(),addNextValue()):"ArrowRight"===r.key?(rightMove(),addNextValue()):"ArrowUp"===r.key?(upMove(),addNextValue()):"ArrowDown"===r.key&&(downMove(),addNextValue())},clearZeros=function(r){return r.filter(function(r){return 0!=r})},handleUpdateTile=function(r,e){r.textContent="",r.classList.value="",r.classList.add("tile"),0!==e&&(r.textContent=e,r.classList.add("tile-animation"),e<=2048)&&r.classList.add("x".concat(e))},leftMove=function(){for(var r=0;r<rowsCount;r++){for(var e=boardArr[r],e=clearZeros(e),o=0;o<e.length-1;o++)e[o]===e[o+1]&&(e[o]*=2,e[o+1]=0);for(e=clearZeros(e);e.length<rowsCount;)e.push(0);boardArr[r]=e;for(var t=0;t<rowsCount;t++){var a=document.getElementById("".concat(r,"-").concat(t)),n=boardArr[r][t];handleUpdateTile(a,n)}}},rightMove=function(){for(var r=0;r<rowsCount;r++){(e=boardArr[r]).reverse();for(var e=clearZeros(e),o=0;o<e.length-1;o++)e[o]===e[o+1]&&(e[o]*=2,e[o+1]=0);for(e=clearZeros(e);e.length<rowsCount;)e.push(0);e.reverse(),boardArr[r]=e;for(var t=0;t<rowsCount;t++){var a=document.getElementById("".concat(r,"-").concat(t)),n=boardArr[r][t];handleUpdateTile(a,n)}}},upMove=function(){for(var r=0;r<columnsCount;r++){for(var e=[boardArr[0][r],boardArr[1][r],boardArr[2][r],boardArr[3][r]],e=clearZeros(e),o=0;o<e.length-1;o++)e[o]===e[o+1]&&(e[o]*=2,e[o+1]=0);for(e=clearZeros(e);e.length<rowsCount;)e.push(0);for(var t=0;t<rowsCount;t++){boardArr[t][r]=e[t];var a=document.getElementById("".concat(t,"-").concat(r)),n=boardArr[t][r];handleUpdateTile(a,n)}}},downMove=function(){for(var r=0;r<columnsCount;r++){(e=[boardArr[0][r],boardArr[1][r],boardArr[2][r],boardArr[3][r]]).reverse();for(var e=clearZeros(e),o=0;o<e.length-1;o++)e[o]===e[o+1]&&(e[o]*=2,e[o+1]=0);for(e=clearZeros(e);e.length<rowsCount;)e.push(0);e.reverse();for(var t=0;t<rowsCount;t++){boardArr[t][r]=e[t];var a=document.getElementById("".concat(t,"-").concat(r)),n=boardArr[t][r];handleUpdateTile(a,n)}}},websiteLoaded=function(){handlePrepareGame()},leftArrow=(window.addEventListener("DOMContentLoaded",websiteLoaded),document.addEventListener("keyup",checkMove),document.querySelector(".arrow-left")),rightArrow=document.querySelector(".arrow-right"),upArrow=document.querySelector(".arrow-up"),downArrow=document.querySelector(".arrow-down");leftArrow.addEventListener("click",function(){leftMove(),addNextValue()}),rightArrow.addEventListener("click",function(){rightMove(),addNextValue()}),upArrow.addEventListener("click",function(){upMove(),addNextValue()}),downArrow.addEventListener("click",function(){downMove(),addNextValue()});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1haW4uanMiXSwibmFtZXMiOlsicm93c0NvdW50IiwiYm9hcmQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJib2FyZEFyciIsImhhbmRsZVByZXBhcmVHYW1lIiwibmV3Um93IiwiY2xhc3NMaXN0IiwibmV3VGlsZSIsInNldEF0dHJpYnV0ZSIsInIiLCJjb25jYXQiLCJhcHBlbmQiLCJjIiwiaGFuZGxlVXBkYXRlVGlsZSIsImNvbHVtbnNDb3VudCIsImFwcGVuZENoaWxkIiwiYWRkTmV4dFZhbHVlIiwibnVtIiwiZW1wdHkiLCJyYW5kb21Sb3ciLCJmb3VuZCIsInJhbmRvbUNvbHVtbiIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNoZWNrTW92ZSIsImxlZnRNb3ZlIiwiZ2V0RWxlbWVudEJ5SWQiLCJ0aWxlIiwiYWRkIiwicmlnaHRNb3ZlIiwiZSIsImtleSIsInJvd3MiLCJmaWx0ZXIiLCJpdGVtIiwidXBNb3ZlIiwidGV4dENvbnRlbnQiLCJpIiwiY2xlYXJaZXJvcyIsImEiLCJnIiwibGVuZ3RoIiwicHVzaCIsInJldmVyc2UiLCJyb3ciLCJwIiwiZG93bk1vdmUiLCJ3ZWJzaXRlTG9hZGVkIiwiYWRkRXZlbnRMaXN0ZW5lciIsImxlZnRBcnJvdyIsImRvd25BcnJvdyIsIndpbmRvdyIsInJpZ2h0QXJyb3ciLCJ1cEFycm93Il0sIm1hcHBpbmdzIjoiYUFBQSxJQUNNQSxTQURBQyxNQUFRQyxTQUFTQyxjQUFjLFFBQVEsRUFDdkNILFVBQVksRUFEWkMsYUFBaUJFLEVBR25CQyxrQkFBUSxXQUVaQSxTQUFNQyxDQUNMRCxDQUFBQSxFQUFBQSxFQUFBQSxFQUFRLEdBT1IsQ0FBQSxFQUFBLEVBQUssRUFBSyxHQUpULENBQUMsRUFLRCxFQUFNRSxFQUFBQSxHQUpOLENBQUMsRUFLREEsRUFBQUEsRUFBT0MsSUFGUixJQUtFQyxJQUFBQSxFQUFRQyxFQUFBQSxFQUFBQSxVQUFpQkMsQ0FBQSxHQUFBQyxDQUoxQixJQUtDTCxFQUFPTSxTQUFP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QSxHQUFZeUIsR0FBRUksRUFBQUMsR0FDYixJQUFBbEIsRUFBQTNCLFNBQUEwQixlQUFBLEdBQUFqQixPQUFBb0MsRUFBQSxHQUFBLEVBQUFwQyxPQUFBK0IsQ0FBQSxDQUFBLEVBQ0t4QixFQUFDZ0MsU0FBQUEsR0FBaUJSLEdBQ3hCTCxpQkFBUVIsRUFBQVgsQ0FBQSxDQUNSRCxDQUNBLENBQ0RtQyxFQUVDbkMsY0FBYyxXQUNkWixrQkFBQyxDQTFCRixFQU1NOEMsV0FKTkUsT0FBT0gsaUJBQWlCLG1CQUFvQkQsYUFBYSxFQUV6RC9DLFNBQVNnRCxpQkFBaUIsUUFBU3hCLFNBQVMsRUFFMUJ4QixTQUFTQyxjQUFjLGFBQWEsR0FDaERtRCxXQUFhcEQsU0FBU0MsY0FBYyxjQUFjLEVBQ2xEb0QsUUFBVXJELFNBQVNDLGNBQWMsV0FBVyxFQUM1Q2lELFVBQVlsRCxTQUFTQyxjQUFjLGFBQWEsRUFFdERnRCxVQUFVRCxpQkFBaUIsUUFBUyxXQUNuQ3ZCLFNBQVEsRUFDUlYsYUFBWSxDQUNiLENBQUMsRUFDRHFDLFdBQVdKLGlCQUFpQixRQUFTLFdBQ3BDbkIsVUFBUyxFQUNUZCxhQUFZLENBQ2IsQ0FBQyxFQUNEc0MsUUFBUUwsaUJBQWlCLFFBQVMsV0FDakNiLE9BQU0sRUFDTnBCLGFBQVksQ0FDYixDQUFDLEVBQ0RtQyxVQUFVRixpQkFBaUIsUUFBUyxXQUNuQ0YsU0FBUSxFQUNSL0IsYUFBWSxDQUNiLENBQUMiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5ib2FyZCcpO1xyXG5jb25zdCByb3dzQ291bnQgPSA0O1xyXG5jb25zdCBjb2x1bW5zQ291bnQgPSA0O1xyXG5sZXQgYm9hcmRBcnI7XHJcblxyXG5jb25zdCBoYW5kbGVQcmVwYXJlR2FtZSA9ICgpID0+IHtcclxuXHRib2FyZEFyciA9IFtcclxuXHRcdFswLCAwLCAwLCAwXSxcclxuXHRcdFswLCAwLCAwLCAwXSxcclxuXHRcdFswLCAwLCAwLCAwXSxcclxuXHRcdFswLCAwLCAwLCAwXSxcclxuXHRdO1xyXG5cclxuXHRmb3IgKGxldCByID0gMDsgciA8IHJvd3NDb3VudDsgcisrKSB7XHJcblx0XHRjb25zdCBuZXdSb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdG5ld1Jvdy5jbGFzc0xpc3QuYWRkKCdyb3cnKTtcclxuXHRcdGZvciAobGV0IGMgPSAwOyBjIDwgY29sdW1uc0NvdW50OyBjKyspIHtcclxuXHRcdFx0bGV0IG5ld1RpbGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcclxuXHRcdFx0bmV3VGlsZS5zZXRBdHRyaWJ1dGUoJ2lkJywgYCR7cn0tJHtjfWApO1xyXG5cdFx0XHRuZXdSb3cuYXBwZW5kKG5ld1RpbGUpO1xyXG5cdFx0XHRsZXQgbnVtID0gYm9hcmRBcnJbcl1bY107XHJcblx0XHRcdGhhbmRsZVVwZGF0ZVRpbGUobmV3VGlsZSwgbnVtKTtcclxuXHRcdFx0Ym9hcmQuYXBwZW5kQ2hpbGQobmV3Um93KTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdGFkZE5leHRWYWx1ZSgpO1xyXG5cdGFkZE5leHRWYWx1ZSgpO1xyXG59O1xyXG5cclxuY29uc3QgZW1wdHkgPSAoKSA9PiB7XHJcblx0Zm9yIChsZXQgciA9IDA7IHIgPCByb3dzQ291bnQ7IHIrKykge1xyXG5cdFx0Zm9yIChsZXQgYyA9IDA7IGMgPCBjb2x1bW5zQ291bnQ7IGMrKykge1xyXG5cdFx0XHRpZiAoYm9hcmRBcnJbcl1bY10gPT0gMCkge1xyXG5cdFx0XHRcdHJldHVybiB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0fVxyXG5cdHJldHVybiBmYWxzZTtcclxufTtcclxuXHJcbmNvbnN0IGFkZE5leHRWYWx1ZSA9ICgpID0+IHtcclxuXHRpZiAoIWVtcHR5KSB7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cclxuXHRsZXQgZm91bmQgPSBmYWxzZTtcclxuXHR3aGlsZSAoIWZvdW5kKSB7XHJcblx0XHRsZXQgcmFuZG9tQ29sdW1uID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNCk7XHJcblx0XHRsZXQgcmFuZG9tUm93ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogNCk7XHJcblxyXG5cdFx0aWYgKGJvYXJkQXJyW3JhbmRvbVJvd11bcmFuZG9tQ29sdW1uXSA9PSAwKSB7XHJcblx0XHRcdGJvYXJkQXJyW3JhbmRvbVJvd11bcmFuZG9tQ29sdW1uXSA9IDI7XHJcblx0XHRcdGxldCB0aWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7cmFuZG9tUm93fS0ke3JhbmRvbUNvbHVtbn1gKTtcclxuXHRcdFx0dGlsZS5pbm5lclRleHQgPSAnMic7XHJcblx0XHRcdHRpbGUuY2xhc3NMaXN0LmFkZCgneDInKTtcclxuXHRcdFx0dGlsZS5jbGFzc0xpc3QuYWRkKCd0aWxlLWFuaW1hdGlvbicpO1xyXG5cclxuXHRcdFx0Zm91bmQgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbmNvbnN0IGNoZWNrTW92ZSA9IChlKSA9PiB7XHJcblx0aWYgKGUua2V5ID09PSAnQXJyb3dMZWZ0Jykge1xyXG5cdFx0bGVmdE1vdmUoKTtcclxuXHRcdGFkZE5leHRWYWx1ZSgpO1xyXG5cdH0gZWxzZSBpZiAoZS5rZXkgPT09ICdBcnJvd1JpZ2h0Jykge1xyXG5cdFx0cmlnaHRNb3ZlKCk7XHJcblx0XHRhZGROZXh0VmFsdWUoKTtcclxuXHR9IGVsc2UgaWYgKGUua2V5ID09PSAnQXJyb3dVcCcpIHtcclxuXHRcdHVwTW92ZSgpO1xyXG5cdFx0YWRkTmV4dFZhbHVlKCk7XHJcblx0fSBlbHNlIGlmIChlLmtleSA9PT0gJ0Fycm93RG93bicpIHtcclxuXHRcdGRvd25Nb3ZlKCk7XHJcblx0XHRhZGROZXh0VmFsdWUoKTtcclxuXHR9XHJcbn07XHJcblxyXG5jb25zdCBjbGVhclplcm9zID0gKHJvd3MpID0+IHtcclxuXHRyZXR1cm4gcm93cy5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0gIT0gMCk7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVVcGRhdGVUaWxlID0gKHRpbGUsIG51bSkgPT4ge1xyXG5cdHRpbGUudGV4dENvbnRlbnQgPSAnJztcclxuXHR0aWxlLmNsYXNzTGlzdC52YWx1ZSA9ICcnO1xyXG5cdHRpbGUuY2xhc3NMaXN0LmFkZCgndGlsZScpO1xyXG5cdGlmIChudW0gIT09IDApIHtcclxuXHRcdHRpbGUudGV4dENvbnRlbnQgPSBudW07XHJcblx0XHR0aWxlLmNsYXNzTGlzdC5hZGQoJ3RpbGUtYW5pbWF0aW9uJyk7XHJcblx0XHRpZiAobnVtIDw9IDIwNDgpIHtcclxuXHRcdFx0dGlsZS5jbGFzc0xpc3QuYWRkKGB4JHtudW19YCk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuY29uc3QgbGVmdE1vdmUgPSAoKSA9PiB7XHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCByb3dzQ291bnQ7IGkrKykge1xyXG5cdFx0bGV0IHJvd3MgPSBib2FyZEFycltpXTtcclxuXHRcdHJvd3MgPSBjbGVhclplcm9zKHJvd3MpO1xyXG5cdFx0Zm9yIChsZXQgYSA9IDA7IGEgPCByb3dzLmxlbmd0aCAtIDE7IGErKykge1xyXG5cdFx0XHRpZiAocm93c1thXSA9PT0gcm93c1thICsgMV0pIHtcclxuXHRcdFx0XHRyb3dzW2FdICo9IDI7XHJcblx0XHRcdFx0cm93c1thICsgMV0gPSAwO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblxyXG5cdFx0cm93cyA9IGNsZWFyWmVyb3Mocm93cyk7XHJcblxyXG5cdFx0d2hpbGUgKHJvd3MubGVuZ3RoIDwgcm93c0NvdW50KSB7XHJcblx0XHRcdHJvd3MucHVzaCgwKTtcclxuXHRcdH1cclxuXHJcblx0XHRib2FyZEFycltpXSA9IHJvd3M7XHJcblxyXG5cdFx0Zm9yIChsZXQgZyA9IDA7IGcgPCByb3dzQ291bnQ7IGcrKykge1xyXG5cdFx0XHRsZXQgdGlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke2l9LSR7Z31gKTtcclxuXHRcdFx0bGV0IG51bSA9IGJvYXJkQXJyW2ldW2ddO1xyXG5cdFx0XHRoYW5kbGVVcGRhdGVUaWxlKHRpbGUsIG51bSk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5cclxuY29uc3QgcmlnaHRNb3ZlID0gKCkgPT4ge1xyXG5cdGZvciAobGV0IGkgPSAwOyBpIDwgcm93c0NvdW50OyBpKyspIHtcclxuXHRcdGxldCByb3dzID0gYm9hcmRBcnJbaV07XHJcblx0XHRyb3dzLnJldmVyc2UoKTtcclxuXHRcdHJvd3MgPSBjbGVhclplcm9zKHJvd3MpO1xyXG5cdFx0Zm9yIChsZXQgYSA9IDA7IGEgPCByb3dzLmxlbmd0aCAtIDE7IGErKykge1xyXG5cdFx0XHRpZiAocm93c1thXSA9PT0gcm93c1thICsgMV0pIHtcclxuXHRcdFx0XHRyb3dzW2FdICo9IDI7XHJcblx0XHRcdFx0cm93c1thICsgMV0gPSAwO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyb3dzID0gY2xlYXJaZXJvcyhyb3dzKTtcclxuXHRcdHdoaWxlIChyb3dzLmxlbmd0aCA8IHJvd3NDb3VudCkge1xyXG5cdFx0XHRyb3dzLnB1c2goMCk7XHJcblx0XHR9XHJcblx0XHRyb3dzLnJldmVyc2UoKTtcclxuXHRcdGJvYXJkQXJyW2ldID0gcm93cztcclxuXHJcblx0XHRmb3IgKGxldCBnID0gMDsgZyA8IHJvd3NDb3VudDsgZysrKSB7XHJcblx0XHRcdGxldCB0aWxlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7aX0tJHtnfWApO1xyXG5cdFx0XHRsZXQgbnVtID0gYm9hcmRBcnJbaV1bZ107XHJcblx0XHRcdGhhbmRsZVVwZGF0ZVRpbGUodGlsZSwgbnVtKTtcclxuXHRcdH1cclxuXHR9XHJcbn07XHJcblxyXG5jb25zdCB1cE1vdmUgPSAoKSA9PiB7XHJcblx0Zm9yIChsZXQgZyA9IDA7IGcgPCBjb2x1bW5zQ291bnQ7IGcrKykge1xyXG5cdFx0bGV0IHJvdyA9IFtib2FyZEFyclswXVtnXSwgYm9hcmRBcnJbMV1bZ10sIGJvYXJkQXJyWzJdW2ddLCBib2FyZEFyclszXVtnXV07XHJcblx0XHRyb3cgPSBjbGVhclplcm9zKHJvdyk7XHJcblx0XHRmb3IgKGxldCBhID0gMDsgYSA8IHJvdy5sZW5ndGggLSAxOyBhKyspIHtcclxuXHRcdFx0aWYgKHJvd1thXSA9PT0gcm93W2EgKyAxXSkge1xyXG5cdFx0XHRcdHJvd1thXSAqPSAyO1xyXG5cdFx0XHRcdHJvd1thICsgMV0gPSAwO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyb3cgPSBjbGVhclplcm9zKHJvdyk7XHJcblx0XHR3aGlsZSAocm93Lmxlbmd0aCA8IHJvd3NDb3VudCkge1xyXG5cdFx0XHRyb3cucHVzaCgwKTtcclxuXHRcdH1cclxuXHJcblx0XHRmb3IgKGxldCBwID0gMDsgcCA8IHJvd3NDb3VudDsgcCsrKSB7XHJcblx0XHRcdGJvYXJkQXJyW3BdW2ddID0gcm93W3BdO1xyXG5cdFx0XHRsZXQgdGlsZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGAke3B9LSR7Z31gKTtcclxuXHRcdFx0bGV0IG51bSA9IGJvYXJkQXJyW3BdW2ddO1xyXG5cdFx0XHRoYW5kbGVVcGRhdGVUaWxlKHRpbGUsIG51bSk7XHJcblx0XHR9XHJcblx0fVxyXG59O1xyXG5jb25zdCBkb3duTW92ZSA9ICgpID0+IHtcclxuXHRmb3IgKGxldCBnID0gMDsgZyA8IGNvbHVtbnNDb3VudDsgZysrKSB7XHJcblx0XHRsZXQgcm93ID0gW2JvYXJkQXJyWzBdW2ddLCBib2FyZEFyclsxXVtnXSwgYm9hcmRBcnJbMl1bZ10sIGJvYXJkQXJyWzNdW2ddXTtcclxuXHRcdHJvdy5yZXZlcnNlKCk7XHJcblx0XHRyb3cgPSBjbGVhclplcm9zKHJvdyk7XHJcblx0XHRmb3IgKGxldCBhID0gMDsgYSA8IHJvdy5sZW5ndGggLSAxOyBhKyspIHtcclxuXHRcdFx0aWYgKHJvd1thXSA9PT0gcm93W2EgKyAxXSkge1xyXG5cdFx0XHRcdHJvd1thXSAqPSAyO1xyXG5cdFx0XHRcdHJvd1thICsgMV0gPSAwO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRyb3cgPSBjbGVhclplcm9zKHJvdyk7XHJcblx0XHR3aGlsZSAocm93Lmxlbmd0aCA8IHJvd3NDb3VudCkge1xyXG5cdFx0XHRyb3cucHVzaCgwKTtcclxuXHRcdH1cclxuXHRcdHJvdy5yZXZlcnNlKCk7XHJcblxyXG5cdFx0Zm9yIChsZXQgcCA9IDA7IHAgPCByb3dzQ291bnQ7IHArKykge1xyXG5cdFx0XHRib2FyZEFycltwXVtnXSA9IHJvd1twXTtcclxuXHRcdFx0bGV0IHRpbGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgJHtwfS0ke2d9YCk7XHJcblx0XHRcdGxldCBudW0gPSBib2FyZEFycltwXVtnXTtcclxuXHRcdFx0aGFuZGxlVXBkYXRlVGlsZSh0aWxlLCBudW0pO1xyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcbmNvbnN0IHdlYnNpdGVMb2FkZWQgPSAoKSA9PiB7XHJcblx0aGFuZGxlUHJlcGFyZUdhbWUoKTtcclxufTtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgd2Vic2l0ZUxvYWRlZCk7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIGNoZWNrTW92ZSk7XHJcblxyXG5jb25zdCBsZWZ0QXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJyb3ctbGVmdCcpO1xyXG5jb25zdCByaWdodEFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFycm93LXJpZ2h0Jyk7XHJcbmNvbnN0IHVwQXJyb3cgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXJyb3ctdXAnKTtcclxuY29uc3QgZG93bkFycm93ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFycm93LWRvd24nKTtcclxuXHJcbmxlZnRBcnJvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuXHRsZWZ0TW92ZSgpO1xyXG5cdGFkZE5leHRWYWx1ZSgpO1xyXG59KTtcclxucmlnaHRBcnJvdy5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuXHRyaWdodE1vdmUoKTtcclxuXHRhZGROZXh0VmFsdWUoKTtcclxufSk7XHJcbnVwQXJyb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblx0dXBNb3ZlKCk7XHJcblx0YWRkTmV4dFZhbHVlKCk7XHJcbn0pO1xyXG5kb3duQXJyb3cuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcblx0ZG93bk1vdmUoKTtcclxuXHRhZGROZXh0VmFsdWUoKTtcclxufSk7XHJcbiJdfQ==
